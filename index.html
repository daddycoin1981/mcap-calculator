<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Memecoin PNL Calculator</title>
  <style>
    body {
      background-color: #0b0f19;
      font-family: 'Arial Rounded MT Bold', sans-serif;
      color: #ffffff;
      text-align: center;
      padding: 30px;
    }
    input, button {
      margin: 8px;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 1em;
    }
    input[type="date"] {
      width: 160px;
    }
    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 95%;
      background-color: #121826;
    }
    th, td {
      padding: 10px;
      border: 1px solid #444;
    }
    .loss-row { background-color: #4a1d1d; }
    .footer { margin-top: 20px; font-size: 0.9em; color: #aaa; }
    .edit-btn { background: #ffaa00; color: black; padding: 5px 10px; margin: 2px; border-radius: 4px; }
    .delete-btn { background: #ff4d4f; color: white; padding: 5px 10px; margin: 2px; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>ðŸ“ˆ Memecoin PNL Calculator</h1>

  <input id="coinName" placeholder="ðŸ’  Coin Name">
  <input id="investment" type="number" placeholder="ðŸ’µ Investment ($)">
  <input id="entryMcap" type="number" placeholder="ðŸŸ¢ Entry MCAP ($)">
  <input id="exitMcap" type="number" placeholder="ðŸ”´ Exit MCAP ($)">
  <button onclick="calculateProfit()">Calculate</button>
  <button onclick="clearFields()">Clear Fields</button>

  <br><br>
  <label>Filter From: <input type="date" id="fromDate"></label>
  <label>To: <input type="date" id="toDate"></label>
  <button onclick="filterTrades()">Filter</button>

  <div id="result"></div>
  <div id="totals"></div>

  <h2>Trade History</h2>
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Date</th>
        <th>ðŸ’  Coin</th>
        <th>ðŸ’µ Investment</th>
        <th>ðŸŸ¢ Entry MCAP</th>
        <th>ðŸ”´ Exit MCAP</th>
        <th>Profit ($)</th>
        <th>Profit (%)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="historyBody"></tbody>
  </table>

  <div class="footer">
    Developed by <strong>10Solup</strong> â€” Follow the dev on <a href="https://x.com/10Solup" target="_blank">X @10Solup</a>
  </div>

  <script>
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");
    let editIndex = -1;

    function calculateProfit() {
      const coin = document.getElementById("coinName").value;
      const inv = parseFloat(document.getElementById("investment").value);
      const entry = parseFloat(document.getElementById("entryMcap").value);
      const exit = parseFloat(document.getElementById("exitMcap").value);
      const fee = 0.4;
      if (!coin || isNaN(inv) || isNaN(entry) || isNaN(exit)) return;

      const profit = ((exit / entry) * inv - inv - fee);
      const percent = ((exit - entry) / entry) * 100;
      const date = new Date().toISOString();

      const record = { date, coin, inv, entry, exit, profit, percent };
      trades.unshift(record);
      localStorage.setItem("trades", JSON.stringify(trades));
      renderTrades(trades);
      clearFields();
    }

    function clearFields() {
      ["coinName","investment","entryMcap","exitMcap"].forEach(id => document.getElementById(id).value = "");
      editIndex = -1;
    }

    function renderTrades(data) {
      const body = document.getElementById("historyBody");
      body.innerHTML = "";
      let total = 0, percentSum = 0, wins = 0, losses = 0;
      data.forEach((t, i) => {
        const row = document.createElement("tr");
        if (t.profit < 0) row.className = "loss-row";
        row.innerHTML = `
          <td>${i + 1}</td>
          <td>${new Date(t.date).toLocaleString()}</td>
          <td>${t.coin}</td>
          <td>$${t.inv.toFixed(2)}</td>
          <td>${t.entry}</td>
          <td>${t.exit}</td>
          <td>$${t.profit.toFixed(2)}</td>
          <td>${t.percent.toFixed(2)}%</td>
          <td>
            <button class="edit-btn" onclick="editRow(${i})">Edit</button>
            <button class="delete-btn" onclick="deleteRow(${i})">Delete</button>
          </td>
        `;
        body.appendChild(row);
        total += t.profit;
        percentSum += t.percent;
        t.profit >= 0 ? wins++ : losses++;
      });
      document.getElementById("totals").innerText =
        `Total Trades: ${data.length} | Net Profit: $${total.toFixed(2)} | Avg Gain: ${(percentSum / data.length || 0).toFixed(2)}% | Wins: ${wins} | Losses: ${losses}`;
    }

    function deleteRow(index) {
      trades.splice(index, 1);
      localStorage.setItem("trades", JSON.stringify(trades));
      renderTrades(trades);
    }

    function editRow(index) {
      const t = trades[index];
      document.getElementById("coinName").value = t.coin;
      document.getElementById("investment").value = t.inv;
      document.getElementById("entryMcap").value = t.entry;
      document.getElementById("exitMcap").value = t.exit;
      trades.splice(index, 1);
      renderTrades(trades);
    }

    function filterTrades() {
      const from = document.getElementById("fromDate").value;
      const to = document.getElementById("toDate").value;
      const fTime = from ? new Date(from).getTime() : -Infinity;
      const tTime = to ? new Date(to).getTime() + 86400000 : Infinity;
      const filtered = trades.filter(t => {
        const d = new Date(t.date).getTime();
        return d >= fTime && d <= tTime;
      });
      renderTrades(filtered);
    }

    renderTrades(trades);
  </script>
</body>
</html>
