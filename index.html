<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“ˆ Memecoin PNL Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  body {
    background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
    font-family: 'Inter', sans-serif;
    color: #f0f0f0;
    padding: 40px;
  }
  h1 {
    text-align: center;
    font-size: 2.5em;
    margin-bottom: 10px;
    color: #00ffa3;
    text-shadow: 0 0 10px rgba(0,255,163,0.5);
  }
  .summary-top {
    text-align: center;
    font-size: 1.2rem;
    margin-bottom: 20px;
  }
  .ticker {
    font-size: 1rem;
    margin-bottom: 10px;
    text-align: center;
  }
  .input-wrapper {
    text-align: center;
    margin-bottom: 20px;
  }
  .input-wrapper input {
    margin: 6px;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #00ffa3;
    background-color: #1e3245;
    color: #fff;
  }
  .input-wrapper input::placeholder {
    color: #aaa;
  }
  .input-wrapper button {
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    background-color: #00ffa3;
    color: #000;
    font-weight: bold;
    margin: 6px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .input-wrapper button:hover {
    background-color: #00cc88;
  }
  table {
    width: 100%;
    margin: 0 auto 40px auto;
    border-collapse: collapse;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0,0,0,0.4);
  }
  th {
    background-color: #112b3c;
    color: #00ffa3;
    padding: 14px;
    font-weight: 600;
    border-bottom: 2px solid #00ffa3;
    cursor: pointer;
  }
  td {
    background-color: #1e3245;
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid #2a4c68;
  }
  .loss-row td {
    background-color: #4a1d1d;
    color: #ff4d4f;
  }
  canvas {
    background-color: #121826;
    border-radius: 10px;
    padding: 20px;
    margin: 40px auto;
    display: block;
    max-width: 920px;
  }
  #celebrate {
    font-size: 4em;
    text-align: center;
    display: none;
    animation: popper 1s ease-in-out;
  }
  @keyframes popper {
    0% { transform: scale(0.5); opacity: 0; }
    50% { transform: scale(1.5); opacity: 1; }
    100% { transform: scale(0.5); opacity: 0; }
  }
  footer {
    margin-top: 60px;
    color: #999;
    font-size: 0.95rem;
    text-align: center;
  }
</style>
</head>
<body>
  <div class="ticker">
    ğŸª™ SOL Price: <span id="solPrice">...</span> | â‚¿ BTC Price: <span id="btcPrice">...</span>
  </div>

  <h1>ğŸ“ˆ Memecoin PNL Calculator</h1>

  <div class="summary-top">
    âœ… <strong>Total Profit:</strong> $<span id="totalProfit">0.00</span> | <span id="totalProfitPct">0.00%</span> &nbsp;&nbsp;
    âŒ <strong>Total Loss:</strong> $<span id="totalLoss">0.00</span> | <span id="totalLossPct">0.00%</span> &nbsp;&nbsp;
    ğŸ”„ <strong>Total Trades:</strong> <span id="totalTrades">0</span>
  </div>

  <div class="input-wrapper">
    <input id="coin" placeholder="ğŸ’  Coin Name" />
    <input id="investment" placeholder="ğŸ’µ Investment ($)" type="number" />
    <input id="entry" placeholder="ğŸŸ¢ Entry MCAP" type="number" />
    <input id="exit" placeholder="ğŸ”´ Exit MCAP" type="number" />
    <button onclick="addTrade()">Add Trade</button>
    <button onclick="clearFields()">Clear Fields</button>
    <button onclick="exportToExcel()">Export to Excel</button>
  </div>

  <div id="celebrate">ğŸ‰</div>

  <table>
    <thead>
      <tr>
        <th onclick="sortTable(0)">#</th>
        <th onclick="sortTable(1)">ğŸ“… Date</th>
        <th onclick="sortTable(2)">ğŸ’  Coin</th>
        <th onclick="sortTable(3)">ğŸ’µ Investment</th>
        <th onclick="sortTable(4)">ğŸŸ¢ Entry MCAP</th>
        <th onclick="sortTable(5)">ğŸ”´ Exit MCAP</th>
        <th onclick="sortTable(6)">ğŸ’° Profit ($)</th>
        <th onclick="sortTable(7)">ğŸ“ˆ Profit (%)</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="historyBody"></tbody>
  </table>

  <canvas id="profitChart" height="100"></canvas>

  <footer>
    Developed by 10Solup | Contact: X/@10solup | YouTube/@10solup
  </footer>

  <script>
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");
    let chart;
    let sortDir = {};

    const sound = new Howl({ src: ['https://assets.mixkit.co/sfx/preview/mixkit-small-group-cheer-and-applause-518.mp3'] });

    async function updatePrices() {
      const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=solana,bitcoin&vs_currencies=usd");
      const json = await res.json();
      document.getElementById("solPrice").innerText = `$${json.solana.usd}`;
      document.getElementById("btcPrice").innerText = `$${json.bitcoin.usd}`;
    }
    updatePrices(); setInterval(updatePrices, 10000);

    document.addEventListener('DOMContentLoaded', () => {
      const inputs = ['coin', 'investment', 'entry', 'exit'];
      inputs.forEach((id, idx) => {
        document.getElementById(id).addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            if (idx < inputs.length - 1) {
              document.getElementById(inputs[idx + 1]).focus();
            } else {
              addTrade();
              document.getElementById('coin').focus();
            }
          }
        });
      });
    });

    function clearFields() {
      document.getElementById("coin").value = "";
      document.getElementById("investment").value = "";
      document.getElementById("entry").value = "";
      document.getElementById("exit").value = "";
      document.getElementById("coin").focus();
    }

    // KEEP REST OF YOUR SCRIPT UNCHANGED INCLUDING addTrade, renderTrades, etc.
  </script>
</body>
</html>
